angular.module('webapp').controller('NewsController',['$scope','NewsService',NewsController]);
function NewsController($scope,NewsService){
	$scope.list=[];
	$scope.current={};
	$scope.new={};
	$scope.save=function(){
		if(!$scope.new.name){
			$scope.editorMessage="姓名不能为空";
			return;
		}
		if(!$scope.new.tel){
			$scope.editorMessage="电话不能为空";
			return;
		}
		if(!$scope.new.email){
			$scope.editorMessage="邮箱不能为空";
			return;
		}
		$scope.editorMessage='';
		NewsService.save($scope.new).then(
			function(data){
				$("#signup").modal('hide')
				$scope.loadNews();
			},
			function(err){
				$scope.editorMessage=err;
			}
		);
	};
	$scope.openNewsDetail=function(id){
		$scope.loadDetail(id);
		$("#part6").modal('show');
	};
	$scope.loadDetail=function(id){
		NewsService.detail(id).then(
			function(data){
				$scope.current=data;
			},
			function(err){}
		);
	};
	$scope.formatTime=function(time){
		return moment(time).format('l');
	}
	$scope.loadNews=function(){
		NewsService.list().then(
			function(data){
				$scope.list=data;
			},
			function(err){}
		);
	};
	$scope.loadNews();
}
